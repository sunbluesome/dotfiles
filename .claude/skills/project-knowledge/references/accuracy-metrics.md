---
title: 精度指標知識ベース
keywords:
  - WMAPE
  - Bias
  - MARE
  - 精度
  - 誤差
  - 予測評価
  - bias_pct
  - bias_pct_median
  - mare_mean
  - mare_median
  - セグメント
  - top_20pct
  - 外れ値
  - median
  - mean
topics:
  - 精度指標定義
  - 計算式
  - 指標解釈
  - 外れ値対応
  - セグメント評価
updated: 2026-01-07
---

# 精度指標知識ベース

予測精度評価で使用する指標の定義、計算式、解釈を記録。

---

## WMAPE (Weighted Mean Absolute Percentage Error)

### 定義
販売量で重み付けした絶対誤差率。

### 計算式
```
WMAPE = Σ|pred - actual| / Σactual
```

### 特徴
- 販売量の多いSKUの誤差が重視される
- 売上への影響度を反映した指標
- 分母が0の場合は1.0にクリップ（inf回避）

### 解釈
| 値 | 解釈 |
|-----|------|
| 0.0 | 完全予測 |
| 0.1 | 10%の誤差（良好） |
| 0.3 | 30%の誤差（許容範囲） |
| 1.0+ | 実績以上の誤差（要改善） |

### 注意点
- **外れ値に敏感**: 一部の高販売量SKUの誤差が全体を支配する可能性
- **スケール**: 比率として表現（0.3 = 30%）

---

## Bias% (Bias Percentage)

### 定義
予測の系統的偏り（過大予測 or 過小予測）。

### 計算式
```
Bias% = Σ(pred - actual) / Σactual
```

### 特徴
- 正の値: 過大予測（予測 > 実績）
- 負の値: 過小予測（予測 < 実績）
- 販売量で重み付け
- 分母が0の場合は1.0にクリップ

### 解釈
| 値 | 解釈 |
|-----|------|
| 0.0 | バイアスなし |
| 0.1 | 10%の過大予測 |
| -0.1 | 10%の過小予測 |
| 111.0 | 実績の111倍の過大予測（異常値） |

### 注意点
- **外れ値に非常に敏感**: 実績がほぼ0のSKUが多い場合、極端な値になる
- **bias_pct_medianと併用**: 外れ値の影響を確認するため

---

## Bias% Median

### 定義
SKU単位の系統的偏りの中央値。

### 計算式
```
Bias% Median = median((pred - actual) / max(1, actual))
```

### 特徴
- SKU単位で計算してから中央値を取る
- 外れ値にロバスト
- 分母は最小1.0（0除算回避）

### 解釈
| 値 | 解釈 |
|-----|------|
| 0.0 | 典型的なSKUはバイアスなし |
| 0.02 | 典型的なSKUは2%の過大予測 |
| -0.1 | 典型的なSKUは10%の過小予測 |

### bias_pctとの比較

| bias_pct | bias_pct_median | 解釈 |
|----------|-----------------|------|
| 111.0 | 0.02 | 少数の外れ値SKUが平均を引き上げ |
| 0.1 | 0.1 | 外れ値なし、均一な誤差分布 |
| 0.1 | -0.05 | 高販売量SKUは過大予測、多くのSKUは過小予測 |

---

## MARE (Mean Absolute Relative Error)

### 定義
SKU単位の相対誤差の平均/中央値。

### 計算式
```
MARE = |pred - actual| / max(1, actual)
mare_mean = mean(MARE per SKU)
mare_median = median(MARE per SKU)
```

### 特徴
- SKU単位で計算
- 販売量に依存しない（重み付けなし）
- 分母は最小1.0

### 解釈
| mare_mean | mare_median | 解釈 |
|-----------|-------------|------|
| 0.1 | 0.1 | 均一な10%誤差 |
| 5.0 | 0.1 | 一部SKUで極端な誤差、多くは10%以下 |
| 0.5 | 0.5 | 全体的に50%の誤差 |

---

## セグメント別評価

### all
全SKUを対象とした評価。

### top_20pct
販売数上位20%のSKUのみを対象とした評価。

### 使い分け
- **all**: 全体傾向の把握
- **top_20pct**: 売上貢献度の高いSKUの精度（ビジネスインパクト大）

---

## 実データでの観測例（2025-10-05基準）

### 典型的な値の範囲

| forecast_day | wmape | bias_pct | bias_pct_median |
|--------------|-------|----------|-----------------|
| 1 | 0.3〜113 | 0.3〜111 | 0.01〜0.04 |
| 7 | 2〜83 | 1.7〜82 | 0.08〜0.16 |
| 14 | 4〜95 | 4〜94 | 0.16〜0.31 |

### 外れ値店舗の特徴
- 予測SKU数: 279
- 実績があるSKU数: 6（day1）
- 予測∩実績SKU数: 2

→ ほとんどのSKUに実績がなく、bias_pctが極端に大きくなる

### 解釈のポイント
1. **bias_pctとbias_pct_medianの乖離が大きい場合**:
   - 少数のSKUに販売が集中 or 予測はあるが実績がないSKUが多い

2. **wmapeとmare_meanの乖離が大きい場合**:
   - 高販売量SKUと低販売量SKUで誤差傾向が異なる

3. **forecast_dayが大きいほど誤差が大きい**:
   - 長期予測は不確実性が高い（期待される傾向）
